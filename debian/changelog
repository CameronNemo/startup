upstart (0.6.3-3) karmic; urgency=low

  * debian/upstart-job:
    - force-reload should only send a HUP signal, since it may not be wise
      to actually restart (cf. dbus)

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 16 Sep 2009 00:10:13 +0100

upstart (0.6.3-2) karmic; urgency=low

  FFE LP: #427356.

  * debian/upstart-job:
    - Remove trailing "s" from file
    - Support direct invocation better.
  * udev/upstart-udev-bridge.c:
    - New tool to capture events from the udev netlink socket and
      convert into upstart events.
  * conf/rc-sysinit.conf:
    - Run once all filesystems are mounted, rather than on startup
  * debian/control:
    - Add dependency on mountall for the filesystem event.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 15 Sep 2009 03:19:09 +0100

upstart (0.6.3-1) karmic; urgency=low

  * New upstream release:
    - Fixed assertion when a job exits while stopping.  LP: #406408.
    - Fixed compilation on ia64.
    - nih-dbus-tool(1) manpage no longer installed.

 -- Scott James Remnant <scott@ubuntu.com>  Mon, 03 Aug 2009 23:58:47 +0100

upstart (0.6.2-1) karmic; urgency=low

  * New upstream release:
    - Fixed assertion when stopping a job during its starting event.
    - Fixed fork following to not stop on exec() before fork()
    - Fixed missing chdir() in crash handler.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 22 Jul 2009 10:39:50 +0100

upstart (0.6.1-1) karmic; urgency=low

  * New upstream release:
    - Fixed race condition in ptrace() code.  LP: #264711.
    - Fixed runlevel to output "unknown" not "N N".  LP: #400248.
    - Fixed runlevel to prefix error messages with filename.  LP: #400241.

  * Provide/Conflict/Replace the agreed "upstart-job" meta-package.
    LP: #399799.
  * Bump dpkg dependency to 1.2.16

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 16 Jul 2009 18:26:23 +0100

upstart (0.6.0-5) karmic; urgency=low

  * Cherry-pick patch from -r1188 to fix "expect fork" and "expect daemon"
    LP: #264711.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 14 Jul 2009 15:19:17 +0100

upstart (0.6.0-4) karmic; urgency=low

  * Don't build the testsuite with -fPIE on armel; LP: #398403.

 -- Lo√Øc Minier <lool@dooz.org>  Mon, 13 Jul 2009 22:12:34 +0200

upstart (0.6.0-3) karmic; urgency=low

  * Add Conflicts on older Upstart packages to make update-manager's
    job easier.

 -- Scott James Remnant <scott@ubuntu.com>  Fri, 10 Jul 2009 10:11:21 +0100

upstart (0.6.0-2) karmic; urgency=low

  * Bump D-Bus build dependency to ensure we get the container abandonment
    patches, and the GIT version bump.
  * Actually ship /lib/init/upstart-job

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 09 Jul 2009 17:29:59 +0100

upstart (0.6.0-1) karmic; urgency=low

  * New upstream release ("How appropriate, you fight like a cow")
    - my customary changes list since pointless, it's basically a
      complete rewrite.
    - Handles /bin/sh symlink disappearing.  LP: #65024.
    - Boot parameters may be passed to init scripts.  LP: #74664.
    - reboot implies --force during shutdown.  LP: #388738.
    - reboot no longer iterates /proc/ide.  LP: #92685.
    - much improved documentation.  LP: #60429, #72058, #388715.

  * Merge the various upstart packages into a single package, it makes
    little sense to have it all spread out.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 08 Jul 2009 23:12:03 +0100

upstart (0.3.10-2) karmic; urgency=low

  * debian/upstart.postinst: Use telinit u to re-exec, rather than
    kill just in case it's not Upstart that's running.  LP: #92177. 
  * debian/event.d/system-services/tty*: Run getty in 8-bit clean
    mode.  LP: #273189. 
  * debian/event.d/upstart-compat-sysv/rc-default:
    - Don't use grep -w, instead split on $IFS and iterate.  LP: #385911.
    - Check for any valid runlevel, not just S.  LP: #85014.
    - Make console owner, since it may spawn sulogin.
  * debian/event.d/upstart-compat-sysv/rcS: 
    - Spawn sulogin if given -b or "emergency".  LP: #193810.
  * debian/event.d/upstart-compat-sysv/rcS:
    - Make console owner.  LP: #211402.
  * debian/event.d/upstart-compat-sysv/rcS-sulogin:
    - Place the telinit code in post-stop, checking $UPSTART_EVENT first so
      we don't change the runlevel if we were stopped due to a runlevel
      change.  LP: #66002.

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 18 Jun 2009 16:19:34 +0100

upstart (0.3.10-1) karmic; urgency=low

  * Compilation fixes.
  * Fixed assertion caused by the post-start or pre-stop scripts
    exiting after the main process of a respawning job had exited.
    LP: #381048.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 17 Jun 2009 13:33:40 +0100

upstart (0.3.9-8) intrepid; urgency=low

  * Do not attempt to continue communicating with the restarted upstart
    (LP: #273761).

 -- Kees Cook <kees@ubuntu.com>  Mon, 29 Sep 2008 13:35:21 -0700

upstart (0.3.9-7) intrepid; urgency=low

  * Implement "telinit u" by just sending Upstart SIGTERM with a slightly
    different patch than Fedora.  LP: #188925.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 23 Sep 2008 09:01:09 -0700

upstart (0.3.9-6) intrepid; urgency=low

  * Really fix LP: #237276 properly this time, lost the change while mucking
    around with bzr.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 04 Jun 2008 22:29:48 +0100

upstart (0.3.9-5) intrepid; urgency=low

  * Correct build problem on amd64 and ia64 by only building libnih and
    libupstart statically.  The shared objects were unwanted, and conflict
    with -fPIE.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 04 Jun 2008 17:07:12 +0100

upstart (0.3.9-4) intrepid; urgency=low

  * Add missing limits.h, required to build with current libc.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 04 Jun 2008 13:09:32 +0100

upstart (0.3.9-3) intrepid; urgency=low

  * Change dependency from sysvutils to sysvinit-utils.  LP: #237276.
  * Compile with stack -fstack-protector, -fPIE, -z relro, -z now and -pie
    (MMmm, pie)

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 04 Jun 2008 12:59:11 +0100

upstart (0.3.9-2) hardy; urgency=low

  * Start the getty on tty1 after the rc script has stopped rather then
    at the same time it starts to avoid overwriting by console messages.
    tty2..6 will still be active if you want an early login.  LP: #65230.
  * If the recovery menu is available start that instead of sulogin when
    entering single-user-mode.

 -- Scott James Remnant <scott@ubuntu.com>  Fri, 11 Apr 2008 13:38:50 +0100

upstart (0.3.9-1) hardy; urgency=low

  * New upstream release:
    - many bug fixes.

  * Update reference to "edgy" in README.Debian to "hardy".  LP: #140037.

 -- Scott James Remnant <scott@ubuntu.com>  Sun, 28 Oct 2007 10:51:59 -0400

upstart (0.3.8-2) gutsy; urgency=low

  * Fix broken migration of old-style 'respawn process' stanzas which
    produced corrupted 'exec' stanzas. Try to fix up files previously
    corrupted by this. LP: #95210

 -- Scott James Remnant <scott@ubuntu.com>  Sun, 28 Oct 2007 10:50:36 -0400

upstart (0.3.8-1) feisty; urgency=low

  * New upstream release:
    - much improved initctl tool.

  * Update my standard prep_/undo_/rm_conffile functions to take into account
    current dpkg behaviour wrt obsolete conffiles.  The conffile is now moved
    out of the way in preinst and the moved file deleted in postinst, or moved
    back in postrm abort-upgrade.  This means it's not there when dpkg
    configures the new version, so the conffile is not left in the list.
  * Purge backups of modified obsolete conffiles when the package is purged.

  * Update runlevel and respawn rule generated in migrate-inittab.pl
    LP: #89314

  * Drop 00-libnih-update.patch and 01-libnih-sparc-ftbfs.patch; new upstream
    release includes an up-to-date libnih which contains both patches.
  * Drop 10-cant-stop-execless-job.patch; included upstream.
  * Drop 20-complex-event-config.patch; this is going to be significantly
    changed upstream, and we don't want to ship something strange.
  * Drop 30-fix-warnings.patch; included upstream.

 -- Scott James Remnant <scott@ubuntu.com>  Sun, 11 Mar 2007 19:19:00 +0000

upstart (0.3.5-2) feisty; urgency=low

  * Changed "start script" to "pre-start script" in sulogin event, the former
    is no longer recognised.

  * Applied 01-libnih-sparc-ftbfs.patch; this updates the signal name list
    to exclude signals not available on that architecture, and add one that's
    unique to it.
  * Applied 30-fix-warnings.patch; this corrects a few warnings that spoiled
    an otherwise clean build log.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 13 Feb 2007 15:56:33 +0000

upstart (0.3.5-1) feisty; urgency=low

  * New upstream release:
    - inotify file descriptor leak fixed.  LP: #83099.
    - inotify support is no longer required.  LP: #68904.
    - new job state machine
    - new event structure, can now include arguments and environment

  * Applied 00-libnih-update.patch; this updates the libnih library to the
    latest bzr trunk version, required for the complex-event-config patch.
  * Applied 10-cant-stop-execless-job.patch from upstream; this corrects a
    bug where jobs without an "exec" or "script" stanza cannot be stopped.
  * Applied 20-complex-event-config.patch from upstream; this is an
    experimental implementation of the "on" keyword that allows definition
    of complex system states.

  * System V compatibility jobs updated to match new event names.
  * rcS job now sets PREVLEVEL and RUNLEVEL.  LP: #76304.

  * NOTE: After this upgrade, init will appear to have "forgotten" the
    process ids of your gettys, etc.  This is not a critical problem and
    will be fixed before release.  Shutdown will still work as normal.

 -- Scott James Remnant <scott@ubuntu.com>  Mon, 12 Feb 2007 13:51:40 +0000

upstart (0.3.1-1) feisty; urgency=low

  * New upstream release:
    - start, stop and status are now symlinks to initctl, not to a
      different, separate utility.
    - initctl completely rewritten to behave properly.
    - some upstart-specific options to shutdown and reboot dropped, as
      these are considered SysV-compat tools.
    - "console none" fixed.  LP: #70782.
    - improved documentation.  LP: #68805.

  * shutdown and reboot moved to upstart-compat-sysv.

  * Replace the /usr/share/doc/* directory in upstart-logd,
    upstart-compat-sysv, system-services and startup-tasks with a symlink to
    /usr/share/doc/upstart.  This was actually done in a previous package,
    but the migration missed.  LP: #70895.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 13 Dec 2006 17:27:37 +0000

upstart (0.2.7-7) edgy; urgency=low

  * Don't abort the postinst if we can't send init SIGTERM.  Ubuntu: #64499.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 10 Oct 2006 10:13:05 +0100

upstart (0.2.7-6) edgy; urgency=low

  * Don't start gettys on tty2 thru tty6 in runlevels 4 and 5 (matches
    our sysvinit configuration).
  * Migrate common changes made to /etc/inittab to /etc/event.d by
    adjusting the installed conffiles.  Ubuntu: #61539.

  * Include missing AUTHORS and NEWS file in the upstart package.
  * Include README.Debian which answers common questions.  Ubuntu: #60429.

 -- Scott James Remnant <scott@ubuntu.com>  Thu,  5 Oct 2006 16:08:34 +0100

upstart (0.2.7-5) edgy; urgency=low

  * Don't set the current runlevel in /var/run/utmp to 0 or 6 if it is
    already either of those two values.  That way we don't end up with
    either 0 or 6 in the PREVLEVEL variable, which can cause
    /etc/init.d/rc to be "efficient" and not bother doing
    anything.  Ubuntu: #63852.

 -- Scott James Remnant <scott@ubuntu.com>  Wed,  4 Oct 2006 14:06:18 +0100

upstart (0.2.7-4) edgy; urgency=low

  * Can't just start rc-default once in single-user mode, because if we
    boot into that, that will just return us back to sulogin again.  Copy
    the script out of rc-default into rcS-sulogin to call telinit with the
    right default runlevel.  Ubuntu: #62189.

  * Add Build-Depend on dpkg-dev (>= 1.13.19) due to our use of
    ${binary:Version}.  Ubuntu: #61693.

 -- Scott James Remnant <scott@ubuntu.com>  Tue, 26 Sep 2006 17:20:42 +0100

upstart (0.2.7-3) edgy; urgency=low

  * Set the runlevel to "S" when we enter sulogin so that it appears
    in utmp.

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 21 Sep 2006 05:37:25 +0100

upstart (0.2.7-2) edgy; urgency=low

  * Ensure that the same version of upstart is installed as the version of
    upstart-compat-sysv and upstart-logd; as the IPC protocol may change
    between releases.

  * Adjust the rcS-sulogin job so that if sulogin exits the default runlevel
    is entered; but if the job is stopped (e.g. by shutdown) it isn't.  The
    solves the regression introduced in the previous release.

  * Revert upstream logd/"quiet" change in favour of doing it in our
    lsb logging functions instead; seems to work better (fsvo better).

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 21 Sep 2006 03:12:33 +0100

upstart (0.2.7-1) edgy; urgency=low

  * New upstream release:
    - logd now writes to the console unless "quiet" is specified
    - runaway jobs caught when they start rather than respawn.  Ubuntu: #59807

  * Fix failure to shutdown while in single-user mode, however this means
    that for edgy you can't exit the sulogin shell to enter the default
    runlevel; explicitly say what works.  Ubuntu: #60626.
  * Drop unnecessary dependency on util-linux.
  * Drop sulogin hack, instead depend on the version of sysvutils that
    includes the real one.  Ubuntu: #60965.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 20 Sep 2006 05:39:16 +0100

upstart (0.2.6-1) edgy; urgency=low

  * New upstream release:
    - fix infinite loop caused by bad waitid() call.  Ubuntu: #59459.
    - halt now behaves as "shutdown -h now".  Ubuntu: #59720.

 -- Scott James Remnant <scott@ubuntu.com>  Wed, 13 Sep 2006 22:16:17 +0100

upstart (0.2.5-1) edgy; urgency=low

  * New upstream release:
    - no longer spins when no stalled event handler.  Ubuntu: #59170.
    - shutdown works when under sysvinit.  Ubuntu: #58523;
    - shutdown -k implemented.  Ubuntu: #58723.
    - telinit sends shutdown event for 0, 1 and 6.  Ubuntu: #58913.
    - basic manual pages included.  Ubuntu: #58724.

  * upstart-compat-sysv Replaces: sysvinit.  Ubuntu: #59427.
  * upstart Recommends: upstart-compat-sysv, startup-tasks & system-services.

  * New upstart-logd package includes the logd daemon that can will log
    output of jobs with "console logged" (the default) in their description
    to /var/log/boot.

  * Add /etc/event.d/rc0 that is run on the "halt" event (neither -H or -P
    given), and modify rc0-halt to run on "system-halt" (-H given) and
    rc0-poweroff to run on "power-off" (-P given).  Ubuntu: #59134.
  * Fix the control-alt-delete job to run on the "ctrlaltdel" event so
    that it's triggered properly.  Ubuntu: #59398.
  * Fix single-user mode.

 -- Scott James Remnant <scott@ubuntu.com>  Sat,  9 Sep 2006 05:10:12 +0100

upstart (0.2.1-7) edgy; urgency=low

  * Remove the Essential tags again, they didn't solve the problem we
    hoped they would (dpkg/apt still won't remove sysvinit without
    serious persuasion) and I don't think these packages should be.

 -- Scott James Remnant <scott@ubuntu.com>  Thu,  7 Sep 2006 02:42:33 +0100

upstart (0.2.1-6) edgy; urgency=low

  * Make packages Essential, and change Depends to Pre-Depends so that the
    packages work when unconfigured (nothing interesting is performed in
    postinst).  Ubuntu: #59005.
  * Sync priority in debian/control with that in the archive (required)
  * Drop warning of dire consequences if you install upstart, seeing as it's
    installed by default.

  * Add new startup-tasks and system-services packages which will contain
    the /etc/event.d files themselves (other than the main ones).
  * Move tty definitions into system-services.
  * Modify tty definitions to start when the rcS task has finished.  This
    puts them in the "right" place when compared to gdm.  Ubuntu: #58630.

  * Correct rcS compatibility script to ignore any information in utmp so
    that all scripts are always run.  Ubuntu: #59203.
  * Make rcS the console owner while it runs, temporary fix for
    Ubuntu: #58609, #58794, #58796
  * Include default control-alt-delete handler that reboots the machine.

 -- Scott James Remnant <scott@ubuntu.com>  Wed,  6 Sep 2006 21:52:48 +0100

upstart (0.2.1-5) edgy; urgency=low

  * upstart-compat-sysv Depends: initscripts (closes: Malone #58979).

 -- Colin Watson <cjwatson@ubuntu.com>  Tue,  5 Sep 2006 12:22:50 +0100

upstart (0.2.1-4) edgy; urgency=low

  * Add missing #! line to top of postrm

 -- Scott James Remnant <scott@ubuntu.com>  Mon,  4 Sep 2006 08:11:16 +0100

upstart (0.2.1-3) edgy; urgency=low

  * Remove the rc0 configuration file shipped in 0.1.0 that causes all
    reboots to become shutdowns.  Ubuntu: #58557.

 -- Scott James Remnant <scott@ubuntu.com>  Sun,  3 Sep 2006 23:24:41 +0100

upstart (0.2.1-2) edgy; urgency=low

  * Don't send the SIGTERM signal unless we're upgrading from a version
    of upstart that supports re-exec; older versions would cause a kernel
    PANIC and change from sysvinit does nothing.

 -- Scott James Remnant <scott@ubuntu.com>  Sat,  2 Sep 2006 17:18:38 +0100

upstart (0.2.1-1) edgy; urgency=low

  * New upstream release:
    - compilation fixes.

 -- Scott James Remnant <scott@ubuntu.com>  Fri,  1 Sep 2006 19:51:41 +0100

upstart (0.2.0-1) edgy; urgency=low

  * New upstream release:
    - upstart includes shutdown, reboot, halt, poweroff, start, stop, status,
      runlevel and telinit utilities.
    - "initctl list" will list active jobs.
    - Events vastly simplified to just simple strings.
  
  * Compatibility tasks for old rc scripts, along with runlevel and telinit
    utilities now shipped in upstart-compat-sysv package.

 -- Scott James Remnant <scott@ubuntu.com>  Fri,  1 Sep 2006 02:38:44 +0100

upstart (0.1.1-1) edgy; urgency=low

  * New upstream release:
    - set PATH and TERM in processes

 -- Scott James Remnant <scott@ubuntu.com>  Fri, 25 Aug 2006 16:17:52 +0200

upstart (0.1.0-2) edgy; urgency=low

  * Oops, rename /sbin/init to /sbin/upstart as documented.  Lost this
    while battling bzr.

 -- Scott James Remnant <scott@ubuntu.com>  Thu, 24 Aug 2006 16:30:54 +0200

upstart (0.1.0-1) edgy; urgency=low
  
  * Initial release.
  
 -- Scott James Remnant <scott@ubuntu.com>  Thu, 24 Aug 2006 14:27:47 +0200
