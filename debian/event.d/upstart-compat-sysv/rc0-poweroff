# rc0-poweroff - runlevel 0 compatibility
#
# This task runs the old sysv-rc runlevel 0 ("halt/poweroff") scripts with
# the environment variables set to power off the system.

start on power-off

stop on shutdown
stop on runlevel-2
stop on runlevel-3
stop on runlevel-4
stop on runlevel-5

env INIT_HALT=POWEROFF
script
	set $(runlevel || true)
	if [ "$2" != "0" ] && [ "$2" != "6" ]; then
	    set $(runlevel --set 0 || true)
        fi

	if [ "$1" != "unknown" ]; then
	    PREVLEVEL=$1
	    RUNLEVEL=$2
	    export PREVLEVEL RUNLEVEL
	fi

	exec /etc/init.d/rc 0
end script
